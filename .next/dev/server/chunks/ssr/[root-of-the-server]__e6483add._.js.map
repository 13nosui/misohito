{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/sugawara/Service/MISOHITO/misohito/src/hooks/useTankaEditor.ts"],"sourcesContent":["import { useState, useRef, ChangeEvent } from 'react';\nimport { TankaSections } from '@/types/post';\n\nconst LIMITS: Record<keyof TankaSections, number> = {\n    kami1: 5,\n    kami2: 7,\n    kami3: 5,\n    shimo1: 7,\n    shimo2: 7,\n};\n\nexport const useTankaEditor = () => {\n    const [sections, setSections] = useState<TankaSections>({\n        kami1: '', kami2: '', kami3: '', shimo1: '', shimo2: ''\n    });\n\n    // 【修正点】useRef は必ずトップレベルで個別に呼び出す\n    const kami1Ref = useRef<HTMLInputElement>(null);\n    const kami2Ref = useRef<HTMLInputElement>(null);\n    const kami3Ref = useRef<HTMLInputElement>(null);\n    const shimo1Ref = useRef<HTMLInputElement>(null);\n    const shimo2Ref = useRef<HTMLInputElement>(null);\n\n    // 参照用にまとめる\n    const inputRefs = {\n        kami1: kami1Ref,\n        kami2: kami2Ref,\n        kami3: kami3Ref,\n        shimo1: shimo1Ref,\n        shimo2: shimo2Ref,\n    };\n\n    const handleChange = (e: ChangeEvent<HTMLInputElement>, key: keyof TankaSections) => {\n        const value = e.target.value;\n        const limit = LIMITS[key];\n\n        // 文字数制限内であれば更新\n        if (value.length <= limit) {\n            setSections(prev => ({ ...prev, [key]: value }));\n        }\n\n        // ぴったり埋まったら次のフィールドへ自動フォーカス\n        if (value.length === limit) {\n            const keys = Object.keys(LIMITS) as (keyof TankaSections)[];\n            const currentIndex = keys.indexOf(key);\n            const nextKey = keys[currentIndex + 1];\n\n            if (nextKey) {\n                inputRefs[nextKey].current?.focus();\n            }\n        }\n    };\n\n    return { sections, inputRefs, handleChange, LIMITS };\n};"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,SAA8C;IAChD,OAAO;IACP,OAAO;IACP,OAAO;IACP,QAAQ;IACR,QAAQ;AACZ;AAEO,MAAM,iBAAiB;IAC1B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAgB;QACpD,OAAO;QAAI,OAAO;QAAI,OAAO;QAAI,QAAQ;QAAI,QAAQ;IACzD;IAEA,gCAAgC;IAChC,MAAM,WAAW,IAAA,+MAAM,EAAmB;IAC1C,MAAM,WAAW,IAAA,+MAAM,EAAmB;IAC1C,MAAM,WAAW,IAAA,+MAAM,EAAmB;IAC1C,MAAM,YAAY,IAAA,+MAAM,EAAmB;IAC3C,MAAM,YAAY,IAAA,+MAAM,EAAmB;IAE3C,WAAW;IACX,MAAM,YAAY;QACd,OAAO;QACP,OAAO;QACP,OAAO;QACP,QAAQ;QACR,QAAQ;IACZ;IAEA,MAAM,eAAe,CAAC,GAAkC;QACpD,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAC5B,MAAM,QAAQ,MAAM,CAAC,IAAI;QAEzB,eAAe;QACf,IAAI,MAAM,MAAM,IAAI,OAAO;YACvB,YAAY,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,CAAC,IAAI,EAAE;gBAAM,CAAC;QAClD;QAEA,2BAA2B;QAC3B,IAAI,MAAM,MAAM,KAAK,OAAO;YACxB,MAAM,OAAO,OAAO,IAAI,CAAC;YACzB,MAAM,eAAe,KAAK,OAAO,CAAC;YAClC,MAAM,UAAU,IAAI,CAAC,eAAe,EAAE;YAEtC,IAAI,SAAS;gBACT,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE;YAChC;QACJ;IACJ;IAEA,OAAO;QAAE;QAAU;QAAW;QAAc;IAAO;AACvD"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/sugawara/Service/MISOHITO/misohito/src/components/post/PostAnimation.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { TankaSections } from '@/types/post';\n\ninterface PostAnimationProps {\n    sections: TankaSections;\n    onComplete?: () => void; // 追加：完了時のコールバック\n}\n\nexport const PostAnimation = ({ sections, onComplete }: PostAnimationProps) => {\n    const sectionKeys: (keyof TankaSections)[] = ['kami1', 'kami2', 'kami3', 'shimo1', 'shimo2'];\n    let globalCharIndex = 0;\n\n    // アニメーション総時間の計算\n    // (31文字 * 0.05) + (5節 * 0.2) + 余裕を持たせて2秒後くらいに切り替え\n    useEffect(() => {\n        if (onComplete) {\n            const totalDuration = (31 * 50) + (5 * 200) + 2000;\n            const timer = setTimeout(() => {\n                onComplete();\n            }, totalDuration);\n            return () => clearTimeout(timer);\n        }\n    }, [onComplete]);\n\n    return (\n        <div className=\"flex flex-col items-center justify-center min-h-[60vh]\">\n            <div className=\"flex flex-wrap items-center justify-center max-w-2xl gap-y-6\">\n                {sectionKeys.map((key, sIndex) => {\n                    const chars = sections[key].split('');\n\n                    return (\n                        <div key={key} className=\"flex mr-[1.5em] last:mr-0\">\n                            {chars.map((char, cIndex) => {\n                                const delay = globalCharIndex * 0.05 + sIndex * 0.2;\n                                globalCharIndex++;\n\n                                return (\n                                    <motion.span\n                                        key={`${key}-${cIndex}`}\n                                        className=\"text-3xl md:text-4xl font-medium tracking-tight text-slate-900\"\n                                        initial={{ opacity: 0, x: -20, filter: 'blur(10px)' }}\n                                        animate={{ opacity: 1, x: 0, filter: 'blur(0px)' }}\n                                        transition={{\n                                            duration: 0.4,\n                                            delay: delay,\n                                            ease: [0.16, 1, 0.3, 1],\n                                        }}\n                                    >\n                                        {char}\n                                    </motion.span>\n                                );\n                            })}\n                        </div>\n                    );\n                })}\n            </div>\n        </div>\n    );\n};"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAWO,MAAM,gBAAgB,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAsB;IACtE,MAAM,cAAuC;QAAC;QAAS;QAAS;QAAS;QAAU;KAAS;IAC5F,IAAI,kBAAkB;IAEtB,gBAAgB;IAChB,kDAAkD;IAClD,IAAA,kNAAS,EAAC;QACN,IAAI,YAAY;YACZ,MAAM,gBAAgB,AAAC,KAAK,KAAO,IAAI,MAAO;YAC9C,MAAM,QAAQ,WAAW;gBACrB;YACJ,GAAG;YACH,OAAO,IAAM,aAAa;QAC9B;IACJ,GAAG;QAAC;KAAW;IAEf,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;sBACV,YAAY,GAAG,CAAC,CAAC,KAAK;gBACnB,MAAM,QAAQ,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC;gBAElC,qBACI,8OAAC;oBAAc,WAAU;8BACpB,MAAM,GAAG,CAAC,CAAC,MAAM;wBACd,MAAM,QAAQ,kBAAkB,OAAO,SAAS;wBAChD;wBAEA,qBACI,8OAAC,oMAAM,CAAC,IAAI;4BAER,WAAU;4BACV,SAAS;gCAAE,SAAS;gCAAG,GAAG,CAAC;gCAAI,QAAQ;4BAAa;4BACpD,SAAS;gCAAE,SAAS;gCAAG,GAAG;gCAAG,QAAQ;4BAAY;4BACjD,YAAY;gCACR,UAAU;gCACV,OAAO;gCACP,MAAM;oCAAC;oCAAM;oCAAG;oCAAK;iCAAE;4BAC3B;sCAEC;2BAVI,GAAG,IAAI,CAAC,EAAE,QAAQ;;;;;oBAanC;mBApBM;;;;;YAuBlB;;;;;;;;;;;AAIhB"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///Users/sugawara/Service/MISOHITO/misohito/src/components/editor/TankaEditor.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport * as Label from '@radix-ui/react-label';\nimport { useTankaEditor } from '@/hooks/useTankaEditor';\nimport { TankaSections } from '@/types/post';\nimport { PostAnimation } from '@/components/post/PostAnimation'; // ←追加\n\nexport const TankaEditor = () => {\n    const { sections, inputRefs, handleChange, LIMITS } = useTankaEditor();\n    const [isPosted, setIsPosted] = useState(false); // 投稿状態管理\n\n    // 全ての節が埋まっているかチェック\n    const isComplete = Object.keys(LIMITS).every(\n        (key) => sections[key as keyof TankaSections].length === LIMITS[key as keyof TankaSections]\n    );\n\n    const handlePost = () => {\n        if (isComplete) {\n            setIsPosted(true);\n        }\n    };\n\n    // 投稿済みならアニメーションを表示\n    if (isPosted) {\n        return <PostAnimation sections={sections} />;\n    }\n\n    return (\n        <div className=\"flex flex-col gap-12 p-6 w-full max-w-3xl mx-auto\">\n\n            {/* 入力エリア */}\n            <div className=\"flex flex-wrap gap-4 items-end justify-center\">\n                {(Object.keys(LIMITS) as Array<keyof TankaSections>).map((key) => (\n                    <div key={key} className=\"flex flex-col items-center gap-3\">\n                        <Label.Root\n                            className=\"text-[10px] text-slate-400 font-medium uppercase tracking-widest\"\n                            htmlFor={key}\n                        >\n                            {LIMITS[key]}\n                        </Label.Root>\n                        <input\n                            ref={inputRefs[key]}\n                            id={key}\n                            type=\"text\"\n                            value={sections[key]}\n                            onChange={(e) => handleChange(e, key)}\n                            placeholder=\"・\"\n                            className={`\n                text-center text-2xl font-medium border-b transition-all outline-none bg-transparent\n                ${sections[key].length === LIMITS[key]\n                                    ? 'border-slate-800 text-slate-900'\n                                    : 'border-slate-200 text-slate-400 focus:border-slate-400'}\n              `}\n                            style={{\n                                width: `${LIMITS[key] * 1.5 + 1}rem` // 文字数に応じた幅\n                            }}\n                        />\n                    </div>\n                ))}\n            </div>\n\n            {/* プレビュー & アクションエリア */}\n            <div className=\"flex flex-col items-center gap-8 animate-in fade-in duration-700\">\n                <div className=\"text-center\">\n                    <p className=\"text-xs text-slate-400 mb-4 font-light tracking-widest\">PREVIEW</p>\n                    <p className=\"text-lg tracking-wider text-slate-600 font-serif\">\n                        {Object.values(sections).filter(Boolean).join('　')}\n                    </p>\n                </div>\n\n                {/* 投稿ボタン：完了時のみ表示 */}\n                <button\n                    onClick={handlePost}\n                    disabled={!isComplete}\n                    className={`\n            px-8 py-3 rounded-full text-sm font-bold tracking-widest transition-all duration-500\n            ${isComplete\n                            ? 'bg-slate-900 text-white hover:bg-slate-700 translate-y-0 opacity-100'\n                            : 'bg-slate-200 text-slate-400 translate-y-4 opacity-0 cursor-not-allowed'}\n          `}\n                >\n                    詠む\n                </button>\n            </div>\n        </div>\n    );\n};"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA,qPAAiE,MAAM;AANvE;;;;;;AAQO,MAAM,cAAc;IACvB,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,YAAY,EAAE,MAAM,EAAE,GAAG,IAAA,gJAAc;IACpE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC,QAAQ,SAAS;IAE1D,mBAAmB;IACnB,MAAM,aAAa,OAAO,IAAI,CAAC,QAAQ,KAAK,CACxC,CAAC,MAAQ,QAAQ,CAAC,IAA2B,CAAC,MAAM,KAAK,MAAM,CAAC,IAA2B;IAG/F,MAAM,aAAa;QACf,IAAI,YAAY;YACZ,YAAY;QAChB;IACJ;IAEA,mBAAmB;IACnB,IAAI,UAAU;QACV,qBAAO,8OAAC,4JAAa;YAAC,UAAU;;;;;;IACpC;IAEA,qBACI,8OAAC;QAAI,WAAU;;0BAGX,8OAAC;gBAAI,WAAU;0BACV,AAAC,OAAO,IAAI,CAAC,QAAuC,GAAG,CAAC,CAAC,oBACtD,8OAAC;wBAAc,WAAU;;0CACrB,8OAAC,yKAAU;gCACP,WAAU;gCACV,SAAS;0CAER,MAAM,CAAC,IAAI;;;;;;0CAEhB,8OAAC;gCACG,KAAK,SAAS,CAAC,IAAI;gCACnB,IAAI;gCACJ,MAAK;gCACL,OAAO,QAAQ,CAAC,IAAI;gCACpB,UAAU,CAAC,IAAM,aAAa,GAAG;gCACjC,aAAY;gCACZ,WAAW,CAAC;;gBAExB,EAAE,QAAQ,CAAC,IAAI,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,GAChB,oCACA,yDAAyD;cACjF,CAAC;gCACa,OAAO;oCACH,OAAO,GAAG,MAAM,CAAC,IAAI,GAAG,MAAM,EAAE,GAAG,CAAC,CAAC,WAAW;gCACpD;;;;;;;uBAtBE;;;;;;;;;;0BA6BlB,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAE,WAAU;0CAAyD;;;;;;0CACtE,8OAAC;gCAAE,WAAU;0CACR,OAAO,MAAM,CAAC,UAAU,MAAM,CAAC,SAAS,IAAI,CAAC;;;;;;;;;;;;kCAKtD,8OAAC;wBACG,SAAS;wBACT,UAAU,CAAC;wBACX,WAAW,CAAC;;YAEpB,EAAE,aACgB,yEACA,yEAAyE;UAC7F,CAAC;kCACM;;;;;;;;;;;;;;;;;;AAMjB"}}]
}